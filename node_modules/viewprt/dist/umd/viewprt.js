!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).viewprt={})}(this,(function(t){"use strict";function e(t,e){var o=this;this.container=t,this.observers=[],this.lastX=0,this.lastY=0;var i=!1,n=function(){i||(i=!0,requestAnimationFrame((function(){for(var t=o.observers,e=o.getState(),n=t.length;n--;)t[n].check(e);o.lastX=e.positionX,o.lastY=e.positionY,i=!1})))},s=e.handleScrollResize,r=this.handler=s?s(n):n,h=function(){(o.mutationObserver=new MutationObserver(n)).observe(document,{attributes:!0,childList:!0,subtree:!0})},a={capture:!0,passive:!0};addEventListener("scroll",r,a),addEventListener("resize",r,a),"loading"!==document.readyState?h():addEventListener("DOMContentLoaded",h)}function o(t){var e=~~t.offset||0;return this.offsetX=null!=t.offsetX?~~t.offsetX:e,this.offsetY=null!=t.offsetY?~~t.offsetY:e,this.container=t.container||document.body,this.once=!!t.once,this.observerCollection=t.observerCollection||n,this.activate()}function i(t){if(void 0===t&&(t={}),!(this instanceof i))return new i(t);this.viewports=new Map,this.handleScrollResize=t.handleScrollResize}e.prototype={getState:function(){var t,e,o,i,n=this,s=n.container,r=n.lastX,h=n.lastY;return s===document.body?(t=window.innerWidth,e=window.innerHeight,o=window.pageXOffset,i=window.pageYOffset):(t=s.offsetWidth,e=s.offsetHeight,o=s.scrollLeft,i=s.scrollTop),{width:t,height:e,positionX:o,positionY:i,directionX:r<o?"right":r>o?"left":"none",directionY:h<i?"down":h>i?"up":"none"}},destroy:function(){var t=this.handler,e=this.mutationObserver;removeEventListener("scroll",t),removeEventListener("resize",t),e&&e.disconnect()}},o.prototype={activate:function(){var t=this.container,o=this.observerCollection,i=o.viewports,n=i.get(t);n||(n=new e(t,o),i.set(t,n));var s=n.observers;return s.indexOf(this)<0&&s.push(this),n},destroy:function(){var t=this.container,e=this.observerCollection.viewports,o=e.get(t);if(o){var i=o.observers,n=i.indexOf(this);n>-1&&i.splice(n,1),i.length||(o.destroy(),e.delete(t))}}};var n=new i;function s(t){if(void 0===t&&(t={}),!(this instanceof s))return new s(t);this.onTop=t.onTop,this.onBottom=t.onBottom,this.onLeft=t.onLeft,this.onRight=t.onRight,this.onFit=t.onFit,this._wasTop=!0,this._wasBottom=!1,this._wasLeft=!0,this._wasRight=!1,this._wasFit=!1;var e=o.call(this,t);this.check(e.getState())}function r(t,e){if(void 0===e&&(e={}),!(this instanceof r))return new r(t,e);this.element=t,this.onEnter=e.onEnter,this.onExit=e.onExit,this._didEnter=!1;var i=o.call(this,e);h(t)&&this.check(i.getState())}function h(t){return t&&t.parentNode}s.prototype=Object.create(o.prototype),s.prototype.constructor=s,s.prototype.check=function(t){var e=this,o=e.onTop,i=e.onBottom,n=e.onLeft,s=e.onRight,r=e.onFit,h=e._wasTop,a=e._wasBottom,c=e._wasLeft,f=e._wasRight,l=e._wasFit,d=e.container,p=e.offsetX,u=e.offsetY,v=e.once,w=d.scrollHeight,g=d.scrollWidth,b=t.width,y=t.height,m=t.positionX,_=t.positionY,E=_-u<=0,L=w>y&&y+_+u>=w,O=m-p<=0,X=g>b&&b+m+p>=g,Y=w<=y&&g<=b,R=!1;i&&!a&&L?i.call(this,d,t):o&&!h&&E?o.call(this,d,t):s&&!f&&X?s.call(this,d,t):n&&!c&&O?n.call(this,d,t):r&&!l&&Y?r.call(this,d,t):R=!0,v&&!R&&this.destroy(),this._wasTop=E,this._wasBottom=L,this._wasLeft=O,this._wasRight=X,this._wasFit=Y},r.prototype=Object.create(o.prototype),r.prototype.constructor=r,r.prototype.check=function(t){var e=this,o=e.container,i=e.onEnter,n=e.onExit,s=e.element,r=e.offsetX,a=e.offsetY,c=e.once,f=e._didEnter;if(!h(s))return this.destroy();var l=function(t,e,o,i,n){var s,r,h,a,c=t.getBoundingClientRect();if(!c.width||!c.height)return!1;var f=window.innerWidth,l=window.innerHeight,d=f,p=0,u=0;if(n===document.body)s=l,r=u,h=d,a=p;else{if(!(c.top<l&&c.bottom>u&&c.left<d&&c.right>p))return!1;var v=n.getBoundingClientRect();s=v.bottom,r=v.top,h=v.right,a=v.left}return c.top<s+o&&c.bottom>r-o&&c.left<h+e&&c.right>a-e}(s,r,a,0,o);!f&&l?(this._didEnter=!0,i&&(i.call(this,s,t),c&&this.destroy())):f&&!l&&(this._didEnter=!1,n&&(n.call(this,s,t),c&&this.destroy()))},t.ElementObserver=r,t.ObserverCollection=i,t.PositionObserver=s,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=viewprt.js.map
